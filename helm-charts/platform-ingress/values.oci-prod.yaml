# ==============================================================================
# Platform Ingress - OCI Production
# ==============================================================================
# TODO: Update domain, edge proxy IP, and vault secrets for production.
# ==============================================================================

domain: adaas-il.com  # TODO: Update for production domain

tls:
  enabled: true
  secretName: platform-oci-prod-tls

certManager:
  enabled: true
  selfSigned:
    enabled: false
  clusterIssuer:
    enabled: true
    name: letsencrypt-prod
  caIssuer:
    enabled: false

controller:
  service:
    type: NodePort
    nodePorts:
      http: 30080
      https: 30443
  config:
    use-forwarded-headers: "true"
    compute-full-forwarded-for: "true"
    use-proxy-protocol: "false"

ingress:
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-buffer-size: "128k"
    nginx.ingress.kubernetes.io/proxy-buffers-number: "4"
    nginx.ingress.kubernetes.io/limit-rps: "100"
    nginx.ingress.kubernetes.io/limit-connections: "50"

keycloak:
  enabled: true
  path: /
  serviceName: keycloak
  serviceNamespace: keycloak
  servicePort: 80
  subdomain: keycloak

argocd:
  enabled: true
  path: /
  serviceName: argocd-server
  serviceNamespace: argocd
  servicePort: 80
  subdomain: argocd
  annotations:
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    nginx.ingress.kubernetes.io/ssl-passthrough: "false"

grafana:
  enabled: true
  path: /
  serviceName: prometheus-grafana
  serviceNamespace: monitoring
  servicePort: 80
  subdomain: grafana

prometheus:
  enabled: true
  path: /
  serviceName: prometheus-kube-prometheus-prometheus
  serviceNamespace: monitoring
  servicePort: 9090
  subdomain: prometheus
  basicAuth:
    enabled: true
    secretName: prometheus-basic-auth
    username: admin
    password: ""

externalSecrets:
  enabled: true
  apiVersion: "v1beta1"
  secretStore:
    name: oci-vault
    kind: ClusterSecretStore
  appSecretKey: "cloudflare"

letsEncrypt:
  enabled: true
  email: akthm.daas@gmail.com  # TODO: Update for production email
  server: https://acme-v02.api.letsencrypt.org/directory
  cloudflare:
    enabled: true
    secretKey: "cloudflare"
    zoneIdEnabled: true
    apiTokenSecretRef:
      name: cloudflare-api-token
      key: api-key
