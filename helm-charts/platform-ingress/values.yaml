# ==============================================================================
# Platform Ingress - Default Values
# ==============================================================================

# Domain configuration
domain: platform.local

# TLS configuration
tls:
  enabled: true
  secretName: platform-tls

# Cert-manager configuration
certManager:
  enabled: true
  # Self-signed issuer configuration
  selfSigned:
    enabled: true
    issuerName: selfsigned-issuer
  # CA issuer (created from self-signed)
  caIssuer:
    enabled: true
    issuerName: platform-ca-issuer
    secretName: platform-ca-secret

# Ingress controller configuration
ingress:
  className: nginx
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-buffer-size: "128k"
    nginx.ingress.kubernetes.io/proxy-buffers-number: "4"

# ==============================================================================
# Service Routes Configuration
# ==============================================================================

# Keycloak Identity Provider
keycloak:
  enabled: true
  path: /keycloak
  serviceName: keycloak
  serviceNamespace: keycloak
  servicePort: 80
  annotations:
    nginx.ingress.kubernetes.io/proxy-buffer-size: "128k"
    # Keycloak requires these for proper header handling
    nginx.ingress.kubernetes.io/proxy-buffers-number: "4"

# ArgoCD GitOps Dashboard
argocd:
  enabled: true
  path: /argo
  serviceName: argocd-server
  serviceNamespace: argocd
  servicePort: 443
  annotations:
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
    nginx.ingress.kubernetes.io/ssl-passthrough: "false"
    # ArgoCD requires gRPC for CLI
    nginx.ingress.kubernetes.io/grpc-backend: "false"

# Grafana Dashboard
grafana:
  enabled: true
  path: /grafana
  serviceName: kube-prometheus-stack-grafana
  serviceNamespace: monitoring
  servicePort: 80
  annotations: {}

# Prometheus (with basic auth)
prometheus:
  enabled: true
  path: /prometheus
  serviceName: kube-prometheus-stack-prometheus
  serviceNamespace: monitoring
  servicePort: 9090
  # Basic auth configuration
  basicAuth:
    enabled: true
    secretName: prometheus-basic-auth
    username: admin
    # Password will be generated or provided via external secret
    password: ""
  annotations:
    nginx.ingress.kubernetes.io/auth-type: "basic"
    nginx.ingress.kubernetes.io/auth-secret: "prometheus-basic-auth"
    nginx.ingress.kubernetes.io/auth-realm: "Prometheus - Authentication Required"
